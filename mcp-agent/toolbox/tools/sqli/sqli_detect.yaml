# ============================================================
# SQL 注入检测工具配置
# ============================================================

name: sqli_detect
version: "1.0"
category: sqli

description:
  short: SQL 注入漏洞检测
  long: |
    检测 SQL 注入漏洞，测试多种常见 payload。
    自动判断是否存在注入点，支持 GET/POST 方法。

examples:
  - name: POST 登录表单测试
    params:
      url: "http://target.com/login.php"
      method: "POST"
      data: "username=admin&password=123456"
      inject_param: "username"
    expected: "检测 username 参数是否存在 SQL 注入"
  
  - name: GET 参数测试
    params:
      url: "http://target.com/user.php"
      method: "GET"
      data: "id=1"
      inject_param: "id"
    expected: "检测 id 参数是否存在 SQL 注入"

params:
  url:
    type: string
    required: true
    description: 目标 URL
    examples: ["http://target.com/login.php"]
  
  method:
    type: string
    required: false
    default: "POST"
    description: HTTP 方法
    enum: [GET, POST]
  
  data:
    type: string
    required: true
    description: |
      请求参数，格式: key1=value1&key2=value2
      GET 请求时为 URL 参数，POST 请求时为表单数据
    examples: ["username=admin&password=test", "id=1&page=1"]
  
  inject_param:
    type: string
    required: true
    description: 要测试注入的参数名
    examples: ["username", "id", "search"]
  
  timeout:
    type: integer
    required: false
    default: 10
    min: 1
    max: 60
    description: 请求超时（秒）

output:
  type: object
  properties:
    url:
      type: string
    inject_param:
      type: string
    vulnerable:
      type: boolean
      description: 是否存在漏洞
    results:
      type: array
      description: 测试结果详情
    flag:
      type: string
      description: 发现的 flag（如果有）
  
  example:
    url: "http://target.com/login.php"
    inject_param: "username"
    vulnerable: true
    results:
      - { payload: "' OR '1'='1", type: "basic_or", indicates_vuln: true }
    flag: null

execution:
  type: python
  script: sqli_detect.py
  timeout: 120

tags: [sqli, web, vuln, injection]
