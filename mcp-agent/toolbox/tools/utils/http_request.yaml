# ============================================================
# 通用 HTTP 请求工具配置
# ============================================================

name: http_request
version: "1.0"
category: utils

description:
  short: 发送自定义 HTTP 请求
  long: |
    通用 HTTP 请求工具，支持各种方法、自定义头、请求体。
    用于需要灵活控制请求的场景。

examples:
  - name: 简单 GET 请求
    params:
      url: "http://example.com/api/users"
    expected: "获取用户列表"
  
  - name: POST JSON 请求
    params:
      url: "http://example.com/api/login"
      method: "POST"
      json_body: '{"username": "admin", "password": "test"}'
      headers: "Content-Type:application/json"
    expected: "发送 JSON 登录请求"
  
  - name: 带 Cookie 请求
    params:
      url: "http://example.com/admin"
      headers: "Cookie:session=abc123;Authorization:Bearer token"
    expected: "带认证头访问"

params:
  url:
    type: string
    required: true
    description: 请求 URL

  method:
    type: string
    required: false
    default: "GET"
    description: HTTP 方法
    enum: [GET, POST, PUT, DELETE, PATCH, HEAD, OPTIONS]

  data:
    type: string
    required: false
    default: ""
    description: 表单数据，格式 key1=value1&key2=value2

  json_body:
    type: string
    required: false
    default: ""
    description: JSON 请求体

  headers:
    type: string
    required: false
    default: ""
    description: |
      自定义请求头，格式: Header1:Value1;Header2:Value2
      例如: Cookie:session=xxx;Authorization:Bearer token
    examples: ["Cookie:session=abc", "Content-Type:application/json"]

  timeout:
    type: integer
    required: false
    default: 10
    min: 1
    max: 60
    description: 请求超时（秒）

output:
  type: object
  properties:
    status:
      type: integer
      description: HTTP 状态码
    length:
      type: integer
      description: 响应长度
    headers:
      type: object
      description: 响应头
    body:
      type: string
      description: 响应体（限制 2000 字符）
    flag:
      type: string
      description: 发现的 flag

execution:
  type: python
  script: http_request.py
  timeout: 120

tags: [http, utils, request]
