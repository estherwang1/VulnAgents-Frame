# ============================================================
# 目录枚举工具配置
# ============================================================

name: dir_enum
version: "1.0"
category: recon

description:
  short: Web 目录枚举
  long: |
    枚举 Web 服务器的目录和文件，发现隐藏路径。
    内置多种字典，支持自定义扩展名。

examples:
  - name: 基础扫描
    params:
      url: "http://example.com"
    expected: "发现 /admin, /login 等目录"
  
  - name: API 目录扫描
    params:
      url: "http://api.example.com"
      wordlist: "api"
    expected: "发现 /api/v1, /swagger 等"
  
  - name: 带扩展名扫描
    params:
      url: "http://example.com"
      extensions: "php,html,txt"
    expected: "发现 .php, .html, .txt 文件"

params:
  url:
    type: string
    required: true
    description: 目标 URL（如 http://example.com）
    examples: ["http://192.168.1.1", "https://target.com"]
  
  wordlist:
    type: string
    required: false
    default: "common"
    description: |
      字典类型：
      - common: 常用目录（默认）
      - api: API 路径
      - backup: 备份文件
      - full: 完整字典
    enum: [common, api, backup, full]
  
  extensions:
    type: string
    required: false
    default: ""
    description: 文件扩展名，逗号分隔
    examples: ["php,html", "jsp,do", "aspx"]
  
  threads:
    type: integer
    required: false
    default: 10
    min: 1
    max: 50
    description: 并发线程数
  
  timeout:
    type: integer
    required: false
    default: 5
    min: 1
    max: 30
    description: 请求超时（秒）

output:
  type: object
  properties:
    url:
      type: string
    found:
      type: array
      description: 发现的路径列表
      items:
        type: object
        properties:
          path: { type: string }
          status: { type: integer }
          size: { type: integer }
    total_checked:
      type: integer
    total_found:
      type: integer
  
  example:
    url: "http://example.com"
    found:
      - { path: "/admin", status: 403, size: 287 }
      - { path: "/api", status: 200, size: 1024 }
      - { path: "/robots.txt", status: 200, size: 45 }
    total_checked: 80
    total_found: 3

execution:
  type: python
  script: dir_enum.py
  timeout: 600

tags: [web, directory, enumeration]
