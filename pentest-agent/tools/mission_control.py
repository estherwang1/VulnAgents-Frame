# -*- coding: utf-8 -*-
"""
Mission Control Tools
任务控制工具
"""

from langchain_core.tools import tool


@tool
def end_mission(reason: str) -> str:
    """
    结束当前渗透测试任务。
    
    当你认为任务已完成时调用此工具，系统会立即生成报告并结束。
    
    调用时机：
    - 成功获取 flag
    - 成功获取敏感数据（数据库内容、配置文件等）
    - 成功获取 shell 或 RCE
    - 发现并验证了关键漏洞
    - 目标已无更多攻击面
    - 用户请求的任务已完成
    
    Args:
        reason: 结束原因，描述为什么任务完成了
        
    Returns:
        确认消息
        
    Example:
        end_mission("FLAG found: shellmates{SQLi_goeS_BrrRrRR}")
        end_mission("成功获取管理员权限，任务完成")
        end_mission("已发现并验证 SQL 注入漏洞，无需继续测试")
    """
    # 这个工具的实际逻辑在节点里处理
    # 这里只返回确认消息，节点会检测到这个工具被调用并设置 state
    return f"任务结束请求已提交。原因: {reason}"


# 导出
MISSION_CONTROL_TOOLS = [end_mission]
