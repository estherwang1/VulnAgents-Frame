# -*- coding: utf-8 -*-
from .remote_tools import (
    generate_stamp,
    get_stamp_info,
    list_stamps,
    add_finding,
    update_stamp_status,
    deploy_and_run_task,
    get_task_status,
    get_task_result,
    cancel_task,
    list_workspace_files,
    read_workspace_file,
    MAIN_AGENT_TOOLS,
    ALL_REMOTE_TOOLS,
)

from .local_tools import (
    write_local_file,
    read_local_file,
    update_mission_log,
    read_mission_log,
    list_local_files,
    LOCAL_TOOLS,
    MAIN_AGENT_LOCAL_TOOLS,
)

from .knowledge_tools import (
    query_cve,
    search_vulnerabilities,
    search_exploits,
    search_knowledge_base,
    KNOWLEDGE_TOOLS,
)

from .toolbox_tools import (
    list_pentest_tools,
    run_tool,
    get_tool_help,
    port_scan,
    dir_scan,
    sqli_test,
    http_get,
    http_post,
    TOOLBOX_TOOLS,
    QUICK_TOOLS,
)


# ============================================================
# 核心修改：子代理工具集加入预装工具调用能力
# ============================================================

SUBAGENT_TOOLS = [
    # 预装工具调用（优先使用这些）
    list_pentest_tools,
    run_tool,
    get_tool_help,
    # 任务管理
    get_task_status,
    get_task_result,
    add_finding,
    list_workspace_files,
    read_workspace_file,
    # 自定义脚本（仅在预装工具不够用时使用）
    deploy_and_run_task,
]

RECON_TOOLS = SUBAGENT_TOOLS + [generate_stamp]

PENTEST_TOOLS = [
    generate_stamp,
    get_stamp_info,
    add_finding,
    list_pentest_tools,
    run_tool,
    get_tool_help,
]

PENTEST_QUICK_TOOLS = [
    generate_stamp,
    get_stamp_info,
    add_finding,
    port_scan,
    dir_scan,
    sqli_test,
    http_get,
]

__all__ = [
    "generate_stamp", "get_stamp_info", "list_stamps", "add_finding",
    "update_stamp_status", "deploy_and_run_task", "get_task_status",
    "get_task_result", "cancel_task", "list_workspace_files", "read_workspace_file",
    "write_local_file", "read_local_file", "update_mission_log", "read_mission_log",
    "list_local_files", "query_cve", "search_vulnerabilities", "search_exploits",
    "search_knowledge_base", "list_pentest_tools", "run_tool", "get_tool_help",
    "port_scan", "dir_scan", "sqli_test", "http_get", "http_post",
    "MAIN_AGENT_TOOLS", "SUBAGENT_TOOLS", "RECON_TOOLS", "ALL_REMOTE_TOOLS",
    "LOCAL_TOOLS", "MAIN_AGENT_LOCAL_TOOLS", "KNOWLEDGE_TOOLS", "TOOLBOX_TOOLS",
    "QUICK_TOOLS", "PENTEST_TOOLS", "PENTEST_QUICK_TOOLS",
]